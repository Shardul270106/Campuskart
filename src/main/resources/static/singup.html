<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campus Kart - Login & Register</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .fade-in {
      animation: fadeIn 1s ease-in-out forwards;
      opacity: 0;
    }
    @keyframes fadeIn {
      to { opacity: 1; }
    }
    .bg-login {
      background: url('https://images.unsplash.com/photo-1605902711622-cfb43c443e26?auto=format&fit=crop&w=1350&q=80') no-repeat center center;
      background-size: cover;
    }
  </style>
</head>
<body class="bg-login min-h-screen flex items-center justify-center">

  <!-- Container -->
  <div class="bg-white rounded-3xl shadow-2xl w-full max-w-md p-8 fade-in transform transition-all duration-700 hover:scale-105">
    <h2 class="text-3xl font-extrabold text-center text-campus-dark mb-6">Welcome to Campus Kart</h2>

    <!-- Tabs -->
    <div class="flex justify-center mb-6 space-x-4">
      <button id="loginTab" class="text-white bg-blue-600 px-4 py-2 rounded-lg font-semibold">Login</button>
      <button id="registerTab" class="text-blue-600 border border-blue-600 px-4 py-2 rounded-lg font-semibold">Register</button>
    </div>

    <!-- LOGIN FORM -->
    <form id="loginForm" class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
        <input type="text" id="loginUsername" required class="w-full p-3 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 transition duration-300">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
        <input type="password" id="loginPassword" required class="w-full p-3 border border-gray-300 rounded-xl focus:ring-blue-500 focus:border-blue-500 transition duration-300">
      </div>

      <button type="submit" class="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow-lg transition duration-300">
        Log In
      </button>
    </form>

    <!-- REGISTER FORM -->
    <form id="registerForm" class="space-y-4 hidden">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
        <input type="text" id="regName" required class="w-full p-3 border border-gray-300 rounded-xl focus:ring-green-500 focus:border-green-500 transition duration-300">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">College ID</label>
        <input type="text" id="regCollegeId" required class="w-full p-3 border border-gray-300 rounded-xl focus:ring-green-500 focus:border-green-500 transition duration-300">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
        <input type="text" id="regUsername" required class="w-full p-3 border border-gray-300 rounded-xl focus:ring-green-500 focus:border-green-500 transition duration-300">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
        <input type="password" id="regPassword" required class="w-full p-3 border border-gray-300 rounded-xl focus:ring-green-500 focus:border-green-500 transition duration-300">
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Mobile Number</label>
        <input type="tel" id="regMobile" required pattern="[0-9]{10}" maxlength="10" class="w-full p-3 border border-gray-300 rounded-xl focus:ring-green-500 focus:border-green-500 transition duration-300">
      </div>

      <button type="submit" class="w-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-xl shadow-lg transition duration-300">
        Register
      </button>
    </form>
  </div>

<script>
  const loginTab = document.getElementById("loginTab");
  const registerTab = document.getElementById("registerTab");
  const loginForm = document.getElementById("loginForm");
  const registerForm = document.getElementById("registerForm");

  loginTab.onclick = () => {
    loginForm.classList.remove("hidden");
    registerForm.classList.add("hidden");
  };

  registerTab.onclick = () => {
    registerForm.classList.remove("hidden");
    loginForm.classList.add("hidden");
  };

  /* LOGIN */

loginForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  const data = {
    username: loginUsername.value,
    password: loginPassword.value
  };

  const res = await fetch("http://localhost:8082/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });

  const text = await res.text();

  if (text.toLowerCase().includes("success")) {
    localStorage.setItem("loggedUser", data.username);
    window.location.href = "marketplace.html";
  } else {
    alert(text);
  }
});


  /* REGISTER */
  registerForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const data = {
      name: document.getElementById("regName").value,
      collegeId: document.getElementById("regCollegeId").value,
      username: document.getElementById("regUsername").value,
      password: document.getElementById("regPassword").value,
      mobile: document.getElementById("regMobile").value
    };

    try {
      const response = await fetch("http://localhost:8082/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const result = await response.text();

      if (response.ok) {
        alert("Registration successful! Please login.");

        // âœ… Switch to login tab automatically
        loginTab.click();

        // optional: clear register form
        registerForm.reset();
      } else {
        alert(result);
      }

    } catch (error) {
      alert("Server error. Try again.");
      console.error(error);
    }
  });


  </script>


</body>
</html>
